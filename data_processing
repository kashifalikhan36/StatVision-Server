import pandas as pd

# Load your dataset
data = pd.read_csv("collected_metrics.csv")  # Replace with your dataset file name

# Define a function to calculate Performance Score
def calculate_performance_score(row):
    return (row['Exit Velocity'] * 0.5) + (row['Hit Distance'] * 0.3) + (row['Launch Angle'] * 0.2)

# Define a function to classify Outcome
def classify_outcome(row):
    if row['Hit Distance'] > 300 and row['Exit Velocity'] > 95:
        return "Home Run"
    elif row['Hit Distance'] > 200:
        return "Double"
    else:
        return "Out"

# Apply the functions to calculate new columns
data['Performance Score'] = data.apply(calculate_performance_score, axis=1)
data['Outcome'] = data.apply(classify_outcome, axis=1)

# Save the updated dataset
data.to_csv("processed_dataset.csv", index=False)

print("Processed dataset saved as 'processed_dataset.csv'")
